<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Once infected, a person can transmit an infectious disease to
another, creating generations of infected individuals. We can define a
matrix describing the number of newly infected individuals in given
categories, such as age, for consecutive generations. This matrix is
called a "next generation matrix" (NGM). We can generate an NGM from two
sources - a conmat_population object (such as the output from
abs_age_lga()), or a conmat_setting_prediction_matrix, which is the
output from extrapolate_polymod() or predict_setting_contacts().'><title>Calculate next generation contact matrices — generate_ngm • conmat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate next generation contact matrices — generate_ngm"><meta property="og:description" content='Once infected, a person can transmit an infectious disease to
another, creating generations of infected individuals. We can define a
matrix describing the number of newly infected individuals in given
categories, such as age, for consecutive generations. This matrix is
called a "next generation matrix" (NGM). We can generate an NGM from two
sources - a conmat_population object (such as the output from
abs_age_lga()), or a conmat_setting_prediction_matrix, which is the
output from extrapolate_polymod() or predict_setting_contacts().'><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">conmat</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/conmat-population.html">Conmat Population Data</a>
    <a class="dropdown-item" href="../articles/data-sources.html">Data Sources</a>
    <a class="dropdown-item" href="../articles/example-pipeline.html">Example Pipeline</a>
    <a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a>
    <a class="dropdown-item" href="../articles/other-data-sources.html">Using other data sources</a>
    <a class="dropdown-item" href="../articles/parallel-computing.html">parallel-computing</a>
    <a class="dropdown-item" href="../articles/visualising-conmat.html">Visualisation gallery</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate next generation contact matrices</h1>
      
      <div class="d-none name"><code>generate_ngm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Once infected, a person can transmit an infectious disease to
another, creating generations of infected individuals. We can define a
matrix describing the number of newly infected individuals in given
categories, such as age, for consecutive generations. This matrix is
called a "next generation matrix" (NGM). We can generate an NGM from two
sources - a <code>conmat_population</code> object (such as the output from
<code><a href="abs_age_data.html">abs_age_lga()</a></code>), or a <code>conmat_setting_prediction_matrix</code>, which is the
output from <code><a href="extrapolate_polymod.html">extrapolate_polymod()</a></code> or <code><a href="predict_setting_contacts.html">predict_setting_contacts()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generate_ngm</span><span class="op">(</span><span class="va">x</span>, <span class="va">age_breaks</span>, <span class="va">R_target</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for conmat_setting_prediction_matrix</span></span>
<span><span class="fu">generate_ngm</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">age_breaks</span>,</span>
<span>  <span class="va">R_target</span>,</span>
<span>  per_capita_household_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">lga_name</span>,</span>
<span>  <span class="va">state_name</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for conmat_population</span></span>
<span><span class="fu">generate_ngm</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">age_breaks</span>,</span>
<span>  <span class="va">R_target</span>,</span>
<span>  per_capita_household_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">lga_name</span>,</span>
<span>  <span class="va">state_name</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>data input - could be a <code>conmat_population</code> (such as the output from
<code><a href="abs_age_data.html">abs_age_lga()</a></code>), or a <code>conmat_setting_prediction_matrix</code>, which is the
output from <code><a href="extrapolate_polymod.html">extrapolate_polymod()</a></code> or <code><a href="predict_setting_contacts.html">predict_setting_contacts()</a></code>.</p></dd>


<dt>age_breaks</dt>
<dd><p>vector depicting age values with the highest age depicted
as <code>Inf</code>. For example, c(seq(0, 85, by = 5), Inf)</p></dd>


<dt>R_target</dt>
<dd><p>target reproduction number</p></dd>


<dt>...</dt>
<dd><p>extra arguments, currently not used</p></dd>


<dt>per_capita_household_size</dt>
<dd><p>default is NULL - which defaults to <code><a href="get_polymod_per_capita_household_size.html">get_polymod_per_capita_household_size()</a></code>, which gives 3.248971</p></dd>


<dt>lga_name</dt>
<dd><p>now defunct, but capturing arguments for informative error</p></dd>


<dt>state_name</dt>
<dd><p>now defunct, but capturing arguments for informative error</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The NGM can be used to calculate the expected number of secondary
infections in a given age group. Given certain age breaks, we compute the
unscaled next generation matrices for that location across different
settings &amp; age groups using the contact rates extrapolated from POLYMOD
survey data on the specified location, adjusted by the per capita
household size and the setting-specific relative per-contact transmission
probability matrices for the same age groups. These NGMs are then scaled
according to a target reproduction number (which is provided as an
argument) using the ratio of the desired R0 and the R0 of the NGM
for the combination of all settings. The R0 of the combination of all
settings is obtained by calculating the unique, positive eigen value of
the combination NGM. This ratio is then used to scale all the setting
specific NGMs.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>When using a setting prediction contact matrix (such as one generated
by <code>extrapolate_polymod</code>, with class <code>conmat_setting_prediction_matrix</code>),
the age breaks specified in <code>generate_ngm</code> must be the same as the age
breaks specified in the synthetic contact matrix, otherwise it will error
as it is trying to multiple incompatible matrices.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">perth</span> <span class="op">&lt;-</span> <span class="fu"><a href="abs_age_data.html">abs_age_lga</a></span><span class="op">(</span><span class="st">"Perth (C)"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">perth_hh</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_per_capita_household_size.html">get_per_capita_household_size</a></span><span class="op">(</span>lga <span class="op">=</span> <span class="st">"Perth (C)"</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># you can also run this without `per_capita_household_size`</span></span></span>
<span class="r-in"><span> <span class="va">perth_ngm_lga</span> <span class="op">&lt;-</span> <span class="fu">generate_ngm</span><span class="op">(</span><span class="va">perth</span>,</span></span>
<span class="r-in"><span>                               age_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">75</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               per_capita_household_size <span class="op">=</span> <span class="va">perth_hh</span>,</span></span>
<span class="r-in"><span>                               R_target <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span>                           </span></span>
<span class="r-in"><span> <span class="va">perth_contact</span> <span class="op">&lt;-</span> <span class="fu"><a href="extrapolate_polymod.html">extrapolate_polymod</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="va">perth</span>,</span></span>
<span class="r-in"><span>   per_capita_household_size <span class="op">=</span> <span class="va">perth_hh</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="va">perth_ngm</span> <span class="op">&lt;-</span> <span class="fu">generate_ngm</span><span class="op">(</span><span class="va">perth_contact</span>,</span></span>
<span class="r-in"><span>                           age_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">75</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           R_target <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>                           </span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># examples not run as they take a long time</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span> <span class="va">perth</span> <span class="op">&lt;-</span> <span class="fu"><a href="abs_age_data.html">abs_age_lga</a></span><span class="op">(</span><span class="st">"Perth (C)"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">perth_contact</span> <span class="op">&lt;-</span> <span class="fu"><a href="extrapolate_polymod.html">extrapolate_polymod</a></span><span class="op">(</span><span class="va">perth</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu">generate_ngm</span><span class="op">(</span><span class="va">perth_contact</span>, age_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">85</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Nicholas Tierney, <a href="https://www.telethonkids.org.au/contact-us/our-people/g/nick-golding/" class="external-link">Nick Golding</a>, <a href="https://aarathybabu.netlify.app/" class="external-link">Aarathy Babu</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

