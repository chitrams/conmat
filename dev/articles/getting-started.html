<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="conmat">
<title>Getting Started • conmat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<meta property="og:description" content="conmat">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">conmat</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.0.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/conmat-population.html">Conmat Population Data</a>
    <a class="dropdown-item" href="../articles/data-sources.html">Data Sources</a>
    <a class="dropdown-item" href="../articles/example-pipeline.html">Example Pipeline</a>
    <a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a>
    <a class="dropdown-item" href="../articles/other-data-sources.html">Using other data sources</a>
    <a class="dropdown-item" href="../articles/parallel-computing.html">Parallel Computing</a>
    <a class="dropdown-item" href="../articles/sir-model.html">SIR modelling with conmat</a>
    <a class="dropdown-item" href="../articles/visualising-conmat.html">Visualisation gallery</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting Started</h1>
            
      
      
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">conmat</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiforecasts/socialmixr" class="external-link">socialmixr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'socialmixr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:utils':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cite</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: nlme</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'nlme'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     collapse</span></span>
<span><span class="co">#&gt; This is mgcv 1.8-41. For overview type 'help("mgcv-package")'.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p>The goal of conmat is to simplify the process of generating synthetic
contact matrices for a given age population.</p>
<p><strong>What is a contact matrix?</strong></p>
<p>Contact matrices describe the degree of contact between individuals
of given age groups. For example, this matrix describes the number of
contacts between individuals.</p>
<pre><code><span><span class="co">#&gt;       0-4 5-9 10-14</span></span>
<span><span class="co">#&gt; 0-4    10   3     4</span></span>
<span><span class="co">#&gt; 5-9     3  11     5</span></span>
<span><span class="co">#&gt; 10-14   4   5    13</span></span></code></pre>
<p>The rows and columns represent the age groups of the people. On the
main diagonal we see that we have a higher number of contacts - showing
that people of similar ages tend to interact more with one another. We
can use the information in these matrices to model how diseases such as
COVID-19 spread in a population through social contact.</p>
<p><strong>Why do we need <em>synthetic</em> contact
matrices?</strong></p>
<p>Contact matrices are produced from empirical data resulting from a
contact survey, which requires individuals to diary the amount and
manner of contact a person has in a day. However, these surveys are
highly time-consuming and expensive to run, meaning that only a handful
of these empirical datasets exist globally.</p>
<p>We can use statistical methods to create <em>synthetic contact
matrices</em>, which are new contact matrices that have been generalised
to new countries based on existing surveys.</p>
<p><strong>Why do we need <code>conmat</code>?</strong></p>
<p>Existing methods only provide outputs of the contact matrices for
each country, or at best, for urban and rural areas for a given country.
We need methods that allow for flexibly creating synthetic contact
matrices for a specified age population. This is because the age
population distribution of many countries (e.g., Australia), are quite
heterogeneous, and assuming it is homogeneous would result in inaccurate
representation of community infection in many regions.</p>
<div class="section level3">
<h3 id="quick-example-using-australian-data">Quick example using Australian data<a class="anchor" aria-label="anchor" href="#quick-example-using-australian-data"></a>
</h3>
<p>Suppose we want to get a contact matrix for a given region in
Australia, let’s say the city of Perth. We can get that from a helper
function, <code>abs_age_lga</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abs_age_data.html">abs_age_lga</a></span><span class="op">(</span><span class="st">"Perth (C)"</span><span class="op">)</span></span>
<span><span class="va">perth</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 4</span> <span style="color: #BB0000;">(conmat_population)</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- age: </span><span style="color: #555555; font-weight: bold;">lower.age.limit</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- population: </span><span style="color: #555555; font-weight: bold;">population</span></span></span>
<span><span class="co">#&gt;    lga       lower.age.limit  year population</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Perth (C)               0  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">1</span>331</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Perth (C)               5  <span style="text-decoration: underline;">2</span>020        834</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Perth (C)              10  <span style="text-decoration: underline;">2</span>020        529</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Perth (C)              15  <span style="text-decoration: underline;">2</span>020        794</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Perth (C)              20  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">3</span>615</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Perth (C)              25  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">5</span>324</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Perth (C)              30  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">4</span>667</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Perth (C)              35  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">3</span>110</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Perth (C)              40  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">1</span>650</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Perth (C)              45  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">1</span>445</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Perth (C)              50  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">1</span>299</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Perth (C)              55  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">1</span>344</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> Perth (C)              60  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">1</span>359</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> Perth (C)              65  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">1</span>145</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> Perth (C)              70  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">1</span>004</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> Perth (C)              75  <span style="text-decoration: underline;">2</span>020        673</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> Perth (C)              80  <span style="text-decoration: underline;">2</span>020        481</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> Perth (C)              85  <span style="text-decoration: underline;">2</span>020        367</span></span></code></pre></div>
<p>(You can learn more about the data sources we provide in
<code>data-sources.Rmd</code>)</p>
<p>We can get a contact matrix made for <code>perth</code> using the
<code>extrapolate_polymod</code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perth_contact</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extrapolate_polymod.html">extrapolate_polymod</a></span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">perth</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">perth_contact</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Setting Prediction Matrices</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">A list of matrices containing the model predicted contact rate between ages in</span></span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">each setting.</span></span></span>
<span><span class="co">#&gt; <span style="font-style: italic;">There are 16 age breaks, ranging 0-75+ years, with a regular 5 year interval</span></span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">home</span>: a 16x16 <span style="color: #0000BB;">&lt;matrix&gt;</span></span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">work</span>: a 16x16 <span style="color: #0000BB;">&lt;matrix&gt;</span></span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">school</span>: a 16x16 <span style="color: #0000BB;">&lt;matrix&gt;</span></span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">other</span>: a 16x16 <span style="color: #0000BB;">&lt;matrix&gt;</span></span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">all</span>: a 16x16 <span style="color: #0000BB;">&lt;matrix&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Access each <span style="color: #0000BB;">&lt;matrix&gt;</span> with `x$name`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> e.g., `x$home`</span></span></code></pre></div>
<p>We can plot this with <code>autoplot</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">perth_contact</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>And you can see each contact matrix in a setting by referring to its
name - for example, the “home” setting contact matrix:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">perth_contact</span><span class="op">$</span><span class="va">home</span></span>
<span><span class="co">#&gt;               [0,5)     [5,10)    [10,15)    [15,20)    [20,25)    [25,30)</span></span>
<span><span class="co">#&gt; [0,5)    0.39743272 0.32858156 0.16266890 0.11549597 0.17737726 0.32337782</span></span>
<span><span class="co">#&gt; [5,10)   0.19517061 0.31631444 0.20405822 0.07308499 0.05366436 0.09450085</span></span>
<span><span class="co">#&gt; [10,15)  0.07340049 0.15501627 0.26262315 0.13052669 0.04629618 0.03647250</span></span>
<span><span class="co">#&gt; [15,20)  0.08129556 0.08660778 0.20361271 0.34617980 0.17117933 0.06733926</span></span>
<span><span class="co">#&gt; [20,25)  0.33520290 0.17073579 0.19389231 0.45958005 0.75033980 0.43371301</span></span>
<span><span class="co">#&gt; [25,30)  1.12422936 0.55310701 0.28100613 0.33259296 0.79787952 1.25287546</span></span>
<span><span class="co">#&gt; [30,35)  1.46981373 1.16733001 0.53958673 0.26907742 0.34942848 0.77286620</span></span>
<span><span class="co">#&gt; [35,40)  0.75228654 1.03184699 0.76692996 0.32500119 0.17969761 0.22452945</span></span>
<span><span class="co">#&gt; [40,45)  0.24714099 0.42175817 0.56434159 0.38442657 0.17519410 0.09664137</span></span>
<span><span class="co">#&gt; [45,50)  0.12258162 0.15477531 0.26467697 0.33499218 0.24021233 0.11346046</span></span>
<span><span class="co">#&gt; [50,55)  0.11634877 0.09453224 0.11980486 0.19681878 0.25441570 0.18843147</span></span>
<span><span class="co">#&gt; [55,60)  0.13583681 0.09907539 0.07972905 0.09715725 0.16291241 0.21212824</span></span>
<span><span class="co">#&gt; [60,65)  0.12409809 0.11019331 0.07728851 0.05785383 0.07334905 0.12295444</span></span>
<span><span class="co">#&gt; [65,70)  0.08047604 0.09043208 0.07481086 0.04645367 0.03568280 0.04680601</span></span>
<span><span class="co">#&gt; [70,75)  0.04563800 0.05602698 0.05732976 0.04134836 0.02651310 0.02292755</span></span>
<span><span class="co">#&gt; [75,Inf) 0.04426322 0.05402899 0.05735758 0.05301371 0.04629475 0.04067223</span></span>
<span><span class="co">#&gt;             [30,35)    [35,40)    [40,45)    [45,50)    [50,55)    [55,60)</span></span>
<span><span class="co">#&gt; [0,5)    0.42309386 0.32249828 0.17482882 0.11643874 0.12111968 0.14046086</span></span>
<span><span class="co">#&gt; [5,10)   0.19959024 0.26274269 0.17721602 0.08732629 0.05845263 0.06085201</span></span>
<span><span class="co">#&gt; [10,15)  0.07008581 0.14835228 0.18013774 0.11344430 0.05627581 0.03720051</span></span>
<span><span class="co">#&gt; [15,20)  0.05451947 0.09806839 0.19141749 0.22397873 0.14421799 0.07071525</span></span>
<span><span class="co">#&gt; [20,25)  0.19008268 0.14557817 0.23420575 0.43119851 0.50050295 0.31834779</span></span>
<span><span class="co">#&gt; [25,30)  0.77343430 0.33462789 0.23767091 0.37468074 0.68194766 0.76257233</span></span>
<span><span class="co">#&gt; [30,35)  1.18337183 0.71235629 0.27862083 0.19726013 0.32950674 0.60259651</span></span>
<span><span class="co">#&gt; [35,40)  0.47832995 0.74598235 0.41641836 0.15812553 0.12221004 0.21381367</span></span>
<span><span class="co">#&gt; [40,45)  0.11337564 0.25235141 0.41451479 0.23314619 0.09520851 0.07604271</span></span>
<span><span class="co">#&gt; [45,50)  0.05977803 0.07136314 0.17362987 0.31201559 0.18803938 0.07732844</span></span>
<span><span class="co">#&gt; [50,55)  0.09111415 0.05032666 0.06469804 0.17158054 0.31976171 0.19028456</span></span>
<span><span class="co">#&gt; [55,60)  0.16775025 0.08864244 0.05202211 0.07103519 0.19156607 0.35290686</span></span>
<span><span class="co">#&gt; [60,65)  0.17318176 0.15183317 0.08300011 0.04953457 0.06990436 0.19371084</span></span>
<span><span class="co">#&gt; [65,70)  0.08608739 0.13403123 0.11850338 0.06277680 0.03878107 0.05928730</span></span>
<span><span class="co">#&gt; [70,75)  0.03335757 0.06575363 0.10223365 0.08777977 0.04847661 0.03283896</span></span>
<span><span class="co">#&gt; [75,Inf) 0.03731198 0.04258510 0.06921557 0.11451449 0.14108751 0.12662847</span></span>
<span><span class="co">#&gt;             [60,65)    [65,70)    [70,75)   [75,Inf)</span></span>
<span><span class="co">#&gt; [0,5)    0.12923192 0.09276131 0.06398890 0.03949403</span></span>
<span><span class="co">#&gt; [5,10)   0.06816025 0.06191473 0.04666018 0.02863430</span></span>
<span><span class="co">#&gt; [10,15)  0.03631734 0.03890983 0.03627042 0.02309264</span></span>
<span><span class="co">#&gt; [15,20)  0.04240693 0.03768949 0.04080715 0.03329481</span></span>
<span><span class="co">#&gt; [20,25)  0.14434743 0.07772649 0.07025032 0.07806026</span></span>
<span><span class="co">#&gt; [25,30)  0.44513693 0.18756273 0.11175844 0.12616273</span></span>
<span><span class="co">#&gt; [30,35)  0.62651639 0.34471913 0.16247928 0.11565443</span></span>
<span><span class="co">#&gt; [35,40)  0.36883088 0.36038124 0.21505704 0.08863433</span></span>
<span><span class="co">#&gt; [40,45)  0.12218423 0.19309132 0.20262997 0.08730195</span></span>
<span><span class="co">#&gt; [45,50)  0.05430515 0.07617760 0.12956877 0.10756643</span></span>
<span><span class="co">#&gt; [50,55)  0.06992880 0.04294051 0.06529161 0.12092723</span></span>
<span><span class="co">#&gt; [55,60)  0.19508361 0.06608822 0.04452763 0.10926521</span></span>
<span><span class="co">#&gt; [60,65)  0.35290261 0.19172258 0.07114219 0.07726893</span></span>
<span><span class="co">#&gt; [65,70)  0.17321190 0.32753478 0.18703148 0.06145177</span></span>
<span><span class="co">#&gt; [70,75)  0.05283892 0.15375773 0.28357109 0.09684605</span></span>
<span><span class="co">#&gt; [75,Inf) 0.09018228 0.07938642 0.15218488 0.24365406</span></span></code></pre></div>
<p>These contact matrices could then be used in subsequent modelling,
such as the input in a SIR (Susceptible, Infected, Recovered) model.</p>
</div>
<div class="section level3">
<h3 id="quick-example-using-world-data">Quick example using world data<a class="anchor" aria-label="anchor" href="#quick-example-using-world-data"></a>
</h3>
<p>Similarly to above, we can access some world data from another data
source - we have some helpers to pull data from the world
population:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">world_data</span> <span class="op">&lt;-</span> <span class="fu">socialmixr</span><span class="fu">::</span><span class="fu"><a href="https://epiforecasts.io/socialmixr/reference/wpp_age.html" class="external-link">wpp_age</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">world_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   country lower.age.limit year population</span></span>
<span><span class="co">#&gt; 1  AFRICA               0 1950   38705049</span></span>
<span><span class="co">#&gt; 2  AFRICA               0 1955   44304214</span></span>
<span><span class="co">#&gt; 3  AFRICA               0 1960   50491493</span></span>
<span><span class="co">#&gt; 4  AFRICA               0 1965   57690110</span></span>
<span><span class="co">#&gt; 5  AFRICA               0 1970   65452837</span></span>
<span><span class="co">#&gt; 6  AFRICA               0 1975   75017430</span></span></code></pre></div>
<p>We can tidy the data up, filtering down to a specified location and
year with the <code>age_population</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nz_2015</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/age_population.html">age_population</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">world_data</span>,</span>
<span>  location_col <span class="op">=</span> <span class="va">country</span>,</span>
<span>  location <span class="op">=</span> <span class="st">"New Zealand"</span>,</span>
<span>  age_col <span class="op">=</span> <span class="va">lower.age.limit</span>,</span>
<span>  year_col <span class="op">=</span> <span class="va">year</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2015</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">nz_2015</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 × 5</span> <span style="color: #BB0000;">(conmat_population)</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- age: </span><span style="color: #555555; font-weight: bold;">lower.age.limit</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- population: </span><span style="color: #555555; font-weight: bold;">population</span></span></span>
<span><span class="co">#&gt;    country      year population lower.age.limit upper.age.limit</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> New Zealand  <span style="text-decoration: underline;">2</span>015     <span style="text-decoration: underline;">308</span>681               0               4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> New Zealand  <span style="text-decoration: underline;">2</span>015     <span style="text-decoration: underline;">315</span>632               5               9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> New Zealand  <span style="text-decoration: underline;">2</span>015     <span style="text-decoration: underline;">297</span>247              10              14</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> New Zealand  <span style="text-decoration: underline;">2</span>015     <span style="text-decoration: underline;">318</span>932              15              19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> New Zealand  <span style="text-decoration: underline;">2</span>015     <span style="text-decoration: underline;">339</span>362              20              24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> New Zealand  <span style="text-decoration: underline;">2</span>015     <span style="text-decoration: underline;">315</span>914              25              29</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> New Zealand  <span style="text-decoration: underline;">2</span>015     <span style="text-decoration: underline;">287</span>537              30              34</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> New Zealand  <span style="text-decoration: underline;">2</span>015     <span style="text-decoration: underline;">273</span>539              35              39</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> New Zealand  <span style="text-decoration: underline;">2</span>015     <span style="text-decoration: underline;">312</span>245              40              44</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> New Zealand  <span style="text-decoration: underline;">2</span>015     <span style="text-decoration: underline;">313</span>312              45              49</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 11 more rows</span></span></span></code></pre></div>
<p>Then we could create a contact matrix for NZ population data for 2015
like so:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nz_contact</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extrapolate_polymod.html">extrapolate_polymod</a></span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">nz_2015</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">nz_contact</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nz_contact</span><span class="op">$</span><span class="va">home</span></span>
<span><span class="co">#&gt;               [0,5)     [5,10)    [10,15)    [15,20)    [20,25)    [25,30)</span></span>
<span><span class="co">#&gt; [0,5)    0.59372117 0.48807593 0.24377912 0.16584841 0.23975317 0.45548642</span></span>
<span><span class="co">#&gt; [5,10)   0.48735618 0.78767181 0.51898987 0.19288384 0.12966106 0.22071700</span></span>
<span><span class="co">#&gt; [10,15)  0.24394805 0.52011652 0.85521627 0.45218987 0.16056629 0.11749698</span></span>
<span><span class="co">#&gt; [15,20)  0.17066896 0.19878333 0.46501097 0.74634166 0.37886666 0.14176243</span></span>
<span><span class="co">#&gt; [20,25)  0.25176429 0.13635788 0.16849356 0.38660988 0.62017139 0.34139229</span></span>
<span><span class="co">#&gt; [25,30)  0.46211055 0.22425759 0.11912318 0.13976177 0.32983320 0.53602158</span></span>
<span><span class="co">#&gt; [30,35)  0.59258512 0.46404285 0.21988147 0.11105734 0.13338957 0.29953916</span></span>
<span><span class="co">#&gt; [35,40)  0.44053422 0.60229377 0.45916574 0.20800220 0.10911204 0.12575089</span></span>
<span><span class="co">#&gt; [40,45)  0.24813611 0.42156753 0.56415008 0.41092584 0.19420400 0.09880733</span></span>
<span><span class="co">#&gt; [45,50)  0.17232679 0.21969047 0.36922131 0.47226512 0.35903885 0.16576368</span></span>
<span><span class="co">#&gt; [50,55)  0.17668769 0.14562290 0.18461788 0.29536175 0.39353569 0.29546690</span></span>
<span><span class="co">#&gt; [55,60)  0.19201905 0.13985880 0.11424333 0.13662510 0.22732424 0.30388208</span></span>
<span><span class="co">#&gt; [60,65)  0.15926284 0.13975180 0.09892502 0.07471056 0.09179506 0.15608975</span></span>
<span><span class="co">#&gt; [65,70)  0.09790455 0.10895449 0.09008584 0.05757998 0.04323414 0.05575062</span></span>
<span><span class="co">#&gt; [70,75)  0.05302412 0.06486384 0.06597804 0.04888336 0.03141857 0.02632443</span></span>
<span><span class="co">#&gt; [75,Inf) 0.05322248 0.06526955 0.06920200 0.06451199 0.05707800 0.05077948</span></span>
<span><span class="co">#&gt;             [30,35)    [35,40)    [40,45)    [45,50)    [50,55)    [55,60)</span></span>
<span><span class="co">#&gt; [0,5)    0.62178022 0.47273161 0.25546533 0.17009553 0.17482914 0.20323908</span></span>
<span><span class="co">#&gt; [5,10)   0.48618700 0.64536061 0.43337937 0.21652618 0.14387863 0.14781271</span></span>
<span><span class="co">#&gt; [10,15)  0.23087433 0.49306630 0.58121593 0.36469323 0.18280251 0.12100258</span></span>
<span><span class="co">#&gt; [15,20)  0.11991586 0.22969215 0.43536014 0.47969941 0.30074955 0.14881154</span></span>
<span><span class="co">#&gt; [20,25)  0.14697309 0.12295252 0.20995680 0.37214425 0.40890406 0.25266113</span></span>
<span><span class="co">#&gt; [25,30)  0.31886747 0.13690412 0.10320521 0.16599688 0.29661069 0.32631605</span></span>
<span><span class="co">#&gt; [30,35)  0.47434704 0.27926066 0.10983187 0.07908944 0.13066467 0.23913330</span></span>
<span><span class="co">#&gt; [35,40)  0.27306178 0.43376575 0.24335324 0.09408603 0.07081651 0.12061829</span></span>
<span><span class="co">#&gt; [40,45)  0.11193671 0.25364723 0.41604280 0.23986879 0.09857511 0.07585060</span></span>
<span><span class="co">#&gt; [45,50)  0.08407456 0.10228690 0.25019328 0.44061859 0.26925538 0.11099486</span></span>
<span><span class="co">#&gt; [50,55)  0.13855966 0.07680014 0.10256560 0.26859440 0.49295805 0.29562369</span></span>
<span><span class="co">#&gt; [55,60)  0.23706275 0.12228840 0.07377991 0.10350946 0.27636552 0.50468265</span></span>
<span><span class="co">#&gt; [60,65)  0.22277113 0.19040752 0.10305079 0.06326389 0.09002586 0.24753763</span></span>
<span><span class="co">#&gt; [65,70)  0.10512420 0.16287373 0.14000115 0.07461175 0.04669411 0.07105616</span></span>
<span><span class="co">#&gt; [70,75)  0.03882415 0.07788079 0.11835254 0.10017738 0.05570677 0.03776983</span></span>
<span><span class="co">#&gt; [75,Inf) 0.04727707 0.05392646 0.08536482 0.13703371 0.16875709 0.15660524</span></span>
<span><span class="co">#&gt;             [60,65)    [65,70)    [70,75)   [75,Inf)</span></span>
<span><span class="co">#&gt; [0,5)    0.18962996 0.13726099 0.09466968 0.05459774</span></span>
<span><span class="co">#&gt; [5,10)   0.16615331 0.15252761 0.11563763 0.06685737</span></span>
<span><span class="co">#&gt; [10,15)  0.11786897 0.12638678 0.11787934 0.07103937</span></span>
<span><span class="co">#&gt; [15,20)  0.09154143 0.08307282 0.08981351 0.06810253</span></span>
<span><span class="co">#&gt; [20,25)  0.11477348 0.06365035 0.05890519 0.06148627</span></span>
<span><span class="co">#&gt; [25,30)  0.18855468 0.07929840 0.04768337 0.05284919</span></span>
<span><span class="co">#&gt; [30,35)  0.25279312 0.14046263 0.06606222 0.04622150</span></span>
<span><span class="co">#&gt; [35,40)  0.21127183 0.21279445 0.12957846 0.05155211</span></span>
<span><span class="co">#&gt; [40,45)  0.11917957 0.19064869 0.20524521 0.08505827</span></span>
<span><span class="co">#&gt; [45,50)  0.07631472 0.10597694 0.18120369 0.14241867</span></span>
<span><span class="co">#&gt; [50,55)  0.10833087 0.06616051 0.10051663 0.17495812</span></span>
<span><span class="co">#&gt; [55,60)  0.27846513 0.09412025 0.06371175 0.15178295</span></span>
<span><span class="co">#&gt; [60,65)  0.45192467 0.24477051 0.09071207 0.10291735</span></span>
<span><span class="co">#&gt; [65,70)  0.20787743 0.39438792 0.22467643 0.07728059</span></span>
<span><span class="co">#&gt; [70,75)  0.06049509 0.17642670 0.32608811 0.10587527</span></span>
<span><span class="co">#&gt; [75,Inf) 0.11945422 0.10561731 0.18426904 0.27097932</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="what-next">What next?<a class="anchor" aria-label="anchor" href="#what-next"></a>
</h3>
<p>From here you might want to:</p>
<ul>
<li>Create a next generation matrix (NGM)</li>
<li>Apply vaccination to an NGM</li>
</ul>
<p>See the vignette, “example pipeline” for more details.</p>
</div>
<div class="section level2">
<h2 id="a-more-in-depth-example">A More in depth example<a class="anchor" aria-label="anchor" href="#a-more-in-depth-example"></a>
</h2>
<p>The above example showed how we might extract a contact matrix based
on the polymod data - this example now shows all the steps that can be
taken for full flexibility, and provides more detail on the initial
datasets that could be used.</p>
<p>First we want to fit the model to the POLYMOD data, which contains
various survey and population data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">conmat</span><span class="op">)</span></span>
<span><span class="va">polymod_contact_data_home</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_polymod_contact_data.html">get_polymod_contact_data</a></span><span class="op">(</span>setting <span class="op">=</span> <span class="st">"home"</span><span class="op">)</span></span>
<span><span class="va">polymod_survey_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_polymod_population.html">get_polymod_population</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The contact data is a data frame containing the age from and to, and
the number of contacts for each of the specified settings, “home”,
“work”, “school”, “other”, or “all” as well as the number of
participants. By default, <code>polymod_contact_data</code> contains
data from “all”, but we’re going to use the “work” set of data, as it
produces an interesting looking dataset. Each row contains survey
information of the number of contacts. Specifically, the number of
contacts from one age group to another age group, and then the number of
participants in that age group.</p>
<p>The survey data, <code>polymod_survey_data</code> contains the lower
age limit and the population in that age group.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polymod_survey_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 × 2</span> <span style="color: #BB0000;">(conmat_population)</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- age: </span><span style="color: #555555; font-weight: bold;">lower.age.limit</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- population: </span><span style="color: #555555; font-weight: bold;">population</span></span></span>
<span><span class="co">#&gt;    lower.age.limit population</span></span>
<span><span class="co">#&gt;              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>               0   1<span style="text-decoration: underline;">852</span>682.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>               5   1<span style="text-decoration: underline;">968</span>449.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>              10   2<span style="text-decoration: underline;">138</span>897.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>              15   2<span style="text-decoration: underline;">312</span>032.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>              20   2<span style="text-decoration: underline;">407</span>486.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>              25   2<span style="text-decoration: underline;">423</span>602.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>              30   2<span style="text-decoration: underline;">585</span>137.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>              35   2<span style="text-decoration: underline;">969</span>393.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>              40   3<span style="text-decoration: underline;">041</span>663.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>              45   2<span style="text-decoration: underline;">809</span>154.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 11 more rows</span></span></span></code></pre></div>
<p>We also provide control over the POLYMOD data retrieved from
<code><a href="../reference/get_polymod_contact_data.html">get_polymod_contact_data()</a></code> via the arguments,
<code>setting</code>, <code>country</code>, and <code>ages</code>. These
allow you to specify the data to be only from certain settings or
countries or ages. See <code><a href="../reference/get_polymod_contact_data.html">?get_polymod_contact_data</a></code> for more
details. Below is a brief example of this:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polymod_contact_data_belgium_0_10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_polymod_contact_data.html">get_polymod_contact_data</a></span><span class="op">(</span></span>
<span>  setting <span class="op">=</span> <span class="st">"work"</span>,</span>
<span>  countries <span class="op">=</span> <span class="st">"Belgium"</span>,</span>
<span>  ages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">polymod_contact_data_belgium_0_10</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,433 × 5</span></span></span>
<span><span class="co">#&gt;    setting age_from age_to contacts participants</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> work           0      0        0            5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> work           0      1        0            3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> work           0      2        0            2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> work           0      3        0            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> work           0      4        0            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> work           0      5        0            5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> work           0      7        0            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> work           0     10        0            5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> work           0     11        0            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> work           0     12        0            1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 3,423 more rows</span></span></span></code></pre></div>
<p>Similarly, you can control the population data, retrieving it only
for certain countries:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_polymod_population.html">get_polymod_population</a></span><span class="op">(</span>countries <span class="op">=</span> <span class="st">"Belgium"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 × 2</span> <span style="color: #BB0000;">(conmat_population)</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- age: </span><span style="color: #555555; font-weight: bold;">lower.age.limit</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- population: </span><span style="color: #555555; font-weight: bold;">population</span></span></span>
<span><span class="co">#&gt;    lower.age.limit population</span></span>
<span><span class="co">#&gt;              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>               0     <span style="text-decoration: underline;">583</span>492</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>               5     <span style="text-decoration: underline;">593</span>148</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>              10     <span style="text-decoration: underline;">632</span>157</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>              15     <span style="text-decoration: underline;">626</span>921</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>              20     <span style="text-decoration: underline;">649</span>588</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>              25     <span style="text-decoration: underline;">663</span>176</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>              30     <span style="text-decoration: underline;">705</span>878</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>              35     <span style="text-decoration: underline;">773</span>177</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>              40     <span style="text-decoration: underline;">823</span>305</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>              45     <span style="text-decoration: underline;">779</span>436</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 11 more rows</span></span></span>
<span><span class="fu"><a href="../reference/get_polymod_population.html">get_polymod_population</a></span><span class="op">(</span>countries <span class="op">=</span> <span class="st">"Finland"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 × 2</span> <span style="color: #BB0000;">(conmat_population)</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- age: </span><span style="color: #555555; font-weight: bold;">lower.age.limit</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- population: </span><span style="color: #555555; font-weight: bold;">population</span></span></span>
<span><span class="co">#&gt;    lower.age.limit population</span></span>
<span><span class="co">#&gt;              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>               0     <span style="text-decoration: underline;">284</span>683</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>               5     <span style="text-decoration: underline;">296</span>753</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>              10     <span style="text-decoration: underline;">330</span>425</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>              15     <span style="text-decoration: underline;">319</span>947</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>              20     <span style="text-decoration: underline;">334</span>180</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>              25     <span style="text-decoration: underline;">331</span>510</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>              30     <span style="text-decoration: underline;">308</span>108</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>              35     <span style="text-decoration: underline;">352</span>962</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>              40     <span style="text-decoration: underline;">379</span>090</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>              45     <span style="text-decoration: underline;">381</span>713</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 11 more rows</span></span></span></code></pre></div>
<p>You can see the available countries in the helpfile with
<code><a href="../reference/get_polymod_population.html">?get_polymod_population</a></code>.</p>
<div class="section level3">
<h3 id="predicting-the-contact-rate">Predicting the contact rate<a class="anchor" aria-label="anchor" href="#predicting-the-contact-rate"></a>
</h3>
<p>We can create a model of the contact <em>rate</em> with the function
<code>fit_single_contact_model</code>. We’re first going to use some
smaller sets of the data, to save on computation time.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2022</span> <span class="op">-</span> <span class="fl">10</span> <span class="op">-</span> <span class="fl">04</span><span class="op">)</span></span>
<span><span class="va">polymod_contact_data_home_small</span> <span class="op">&lt;-</span> <span class="va">polymod_contact_data_home</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">age_from</span> <span class="op">&lt;=</span> <span class="fl">30</span>,</span>
<span>    <span class="va">age_to</span> <span class="op">&lt;=</span> <span class="fl">30</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">polymod_survey_data_small</span> <span class="op">&lt;-</span> <span class="va">polymod_survey_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">lower.age.limit</span> <span class="op">&lt;=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="va">contact_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_single_contact_model.html">fit_single_contact_model</a></span><span class="op">(</span></span>
<span>  contact_data <span class="op">=</span> <span class="va">polymod_contact_data_home_small</span>,</span>
<span>  population <span class="op">=</span> <span class="va">polymod_survey_data_small</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This fits a generalised additive model (GAM), predicting the contact
rate, based on a series of prediction terms that describe various
features of the contact rates.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contact_model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: poisson </span></span>
<span><span class="co">#&gt; Link function: log </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; contacts ~ s(gam_age_offdiag) + s(gam_age_offdiag_2) + s(gam_age_diag_prod) + </span></span>
<span><span class="co">#&gt;     s(gam_age_diag_sum) + s(gam_age_pmax) + s(gam_age_pmin) + </span></span>
<span><span class="co">#&gt;     school_probability + work_probability + offset(log_contactable_population)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span><span class="co">#&gt; 7.15 1.00 4.84 1.00 5.59 4.55  total = 27.13 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; fREML score: 1656.018     rank: 55/57</span></span></code></pre></div>
<p>We can use this contact model to then predict the contact rate in a
new population.</p>
<p>As a demonstration, let’s take an age population from a given LGA in
Australia (this was the initial motivation for the package, so there are
some helper functions for Australian specific data).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fairfield</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/abs_age_data.html">abs_age_lga</a></span><span class="op">(</span><span class="st">"Fairfield (C)"</span><span class="op">)</span></span>
<span><span class="va">fairfield</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 4</span> <span style="color: #BB0000;">(conmat_population)</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- age: </span><span style="color: #555555; font-weight: bold;">lower.age.limit</span></span></span>
<span><span class="co">#&gt;  <span style="color: #555555;">- population: </span><span style="color: #555555; font-weight: bold;">population</span></span></span>
<span><span class="co">#&gt;    lga           lower.age.limit  year population</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Fairfield (C)               0  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">12</span>261</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Fairfield (C)               5  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">13</span>093</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Fairfield (C)              10  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">13</span>602</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Fairfield (C)              15  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">14</span>323</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Fairfield (C)              20  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">15</span>932</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Fairfield (C)              25  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">16</span>190</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Fairfield (C)              30  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">14</span>134</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Fairfield (C)              35  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">13</span>034</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Fairfield (C)              40  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">12</span>217</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Fairfield (C)              45  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">13</span>449</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> Fairfield (C)              50  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">13</span>419</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> Fairfield (C)              55  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">13</span>652</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> Fairfield (C)              60  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">12</span>907</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> Fairfield (C)              65  <span style="text-decoration: underline;">2</span>020      <span style="text-decoration: underline;">10</span>541</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> Fairfield (C)              70  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">8</span>227</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> Fairfield (C)              75  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">5</span>598</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> Fairfield (C)              80  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">4</span>006</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> Fairfield (C)              85  <span style="text-decoration: underline;">2</span>020       <span style="text-decoration: underline;">4</span>240</span></span></code></pre></div>
<p>We can then pass the contact model through to
<code>predict_contacts</code>, along with the fairfield age population
data, and some age breaks that we want to predict to. Note that these
age breaks could be any size, we just have them set to 5 year age
brackets in most of the examples, but these could be 1 year, 2 year, or
even sub year.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2022</span> <span class="op">-</span> <span class="fl">10</span> <span class="op">-</span> <span class="fl">04</span><span class="op">)</span></span>
<span><span class="va">synthetic_contact_fairfield</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_contacts.html">predict_contacts</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">contact_model</span>,</span>
<span>  population <span class="op">=</span> <span class="va">fairfield</span>,</span>
<span>  age_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">synthetic_contact_fairfield</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 49 × 3</span></span></span>
<span><span class="co">#&gt;    age_group_from age_group_to contacts</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> [0,5)          [0,5)        1.80<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> [0,5)          [5,10)       1.61<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> [0,5)          [10,15)      8.60<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> [0,5)          [15,20)      5.68<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> [0,5)          [20,25)      8.60<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> [0,5)          [25,30)      1.80<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> [0,5)          [30,Inf)     2.40<span style="color: #949494;">e</span>+21</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> [5,10)         [0,5)        1.53<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> [5,10)         [5,10)       2.51<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> [5,10)         [10,15)      1.88<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 39 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h3>
<p>Let’s visualise the matrix to get a sense of the predictions with
<code>autoplot</code>. First we need to transform the predictions to a
matrix:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">synthetic_contact_fairfield</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/predictions_to_matrix.html">predictions_to_matrix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/plot-matrix-differents-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h3>
<p>It is worth noting that the contact matrices created using this
package are transposed when compared to the contact matrices discussed
by <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005697" class="external-link">Prem</a>
and <a href="https://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.0050074" class="external-link">Mossong</a>.
That is, the rows are “age group to”, and the columns are “age group
from”.</p>
</div>
<div class="section level3">
<h3 id="applying-the-model-across-all-settings-">Applying the model across all settings.<a class="anchor" aria-label="anchor" href="#applying-the-model-across-all-settings-"></a>
</h3>
<p>Our experience has been that we would be fitting the same models to
each setting when doing data analysis when using conmat. Accordingly,
you can also fit a model for all of the settings all at once with the
functions, <code><a href="../reference/fit_setting_contacts.html">fit_setting_contacts()</a></code>, and
<code><a href="../reference/predict_setting_contacts.html">predict_setting_contacts()</a></code>. This means we can do the above,
but for each setting, “home”, “work”, “school”, “other”, and “all”, at
once. If we want to use all of the POLYMOD data, we can also use the
<code><a href="../reference/extrapolate_polymod.html">extrapolate_polymod()</a></code> function.</p>
<div class="section level4">
<h4 id="fit-to-all-settings">Fit to all settings<a class="anchor" aria-label="anchor" href="#fit-to-all-settings"></a>
</h4>
<p>We can create a model for each of the settings with
<code><a href="../reference/fit_setting_contacts.html">fit_setting_contacts()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2021</span> <span class="op">-</span> <span class="fl">09</span> <span class="op">-</span> <span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="va">polymod_setting_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_polymod_setting_data.html">get_polymod_setting_data</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">polymod_setting_data_small</span> <span class="op">&lt;-</span> <span class="va">polymod_setting_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">age_from</span> <span class="op">&lt;=</span> <span class="fl">20</span>, <span class="va">age_to</span> <span class="op">&lt;=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">setting_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_setting_contacts.html">fit_setting_contacts</a></span><span class="op">(</span></span>
<span>  contact_data_list <span class="op">=</span> <span class="va">polymod_setting_data_small</span>,</span>
<span>  population <span class="op">=</span> <span class="va">polymod_survey_data</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This contains a list of models, one for each setting. We can look at
one, and get summary information out:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">setting_models</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "home"   "work"   "school" "other"</span></span>
<span><span class="va">setting_models</span><span class="op">$</span><span class="va">home</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: poisson </span></span>
<span><span class="co">#&gt; Link function: log </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; contacts ~ s(gam_age_offdiag) + s(gam_age_offdiag_2) + s(gam_age_diag_prod) + </span></span>
<span><span class="co">#&gt;     s(gam_age_diag_sum) + s(gam_age_pmax) + s(gam_age_pmin) + </span></span>
<span><span class="co">#&gt;     school_probability + work_probability + offset(log_contactable_population)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span><span class="co">#&gt; 6.239 1.000 4.863 1.000 0.698 4.394  total = 21.19 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; fREML score: 789.9536     rank: 55/57</span></span></code></pre></div>
<p>So this gives us our baseline model of a contact model. We have fit
this model to the existing contact survey data. We can now predict to
another age population, to create our “synthetic” contact matrix.</p>
</div>
<div class="section level4">
<h4 id="predict-to-all-settings">Predict to all settings<a class="anchor" aria-label="anchor" href="#predict-to-all-settings"></a>
</h4>
<p>Then we take the model we had earlier, and extrapolate to the
fairfield data with <code>predict_setting_contacts</code>, also
providing some age breaks we want to predict to</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2021</span> <span class="op">-</span> <span class="fl">10</span> <span class="op">-</span> <span class="fl">04</span><span class="op">)</span></span>
<span><span class="va">synthetic_settings_5y_fairfield</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_setting_contacts.html">predict_setting_contacts</a></span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="va">fairfield</span>,</span>
<span>  contact_model <span class="op">=</span> <span class="va">setting_models</span>,</span>
<span>  age_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This then returns a list of synthetic matrices, “home”, “work”,
“school”, “other”, and “all”, which is the sum of all matrices.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">synthetic_settings_5y_fairfield</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 5</span></span>
<span><span class="co">#&gt;  $ home  : 'conmat_age_matrix' num [1:5, 1:5] 1.16e-01 1.04e-01 5.74e-02 3.52e-02 1.77e+34 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "[0,5)" "[5,10)" "[10,15)" "[15,20)" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "[0,5)" "[5,10)" "[10,15)" "[15,20)" ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "age_breaks")= num [1:6] 0 5 10 15 20 ...</span></span>
<span><span class="co">#&gt;  $ work  : 'conmat_age_matrix' num [1:5, 1:5] 0.000244 0.00015 0.000143 0.00217 0.000367 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "[0,5)" "[5,10)" "[10,15)" "[15,20)" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "[0,5)" "[5,10)" "[10,15)" "[15,20)" ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "age_breaks")= num [1:6] 0 5 10 15 20 ...</span></span>
<span><span class="co">#&gt;  $ school: 'conmat_age_matrix' num [1:5, 1:5] 0.76853 0.1457 0.0087 0.00949 Inf ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "[0,5)" "[5,10)" "[10,15)" "[15,20)" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "[0,5)" "[5,10)" "[10,15)" "[15,20)" ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "age_breaks")= num [1:6] 0 5 10 15 20 ...</span></span>
<span><span class="co">#&gt;  $ other : 'conmat_age_matrix' num [1:5, 1:5] 1.64e-01 9.77e-02 3.89e-02 2.61e-02 2.68e+38 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "[0,5)" "[5,10)" "[10,15)" "[15,20)" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "[0,5)" "[5,10)" "[10,15)" "[15,20)" ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "age_breaks")= num [1:6] 0 5 10 15 20 ...</span></span>
<span><span class="co">#&gt;  $ all   : 'conmat_age_matrix' num [1:5, 1:5] 1.0486 0.3475 0.1051 0.0729 Inf ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "age_breaks")= num [1:6] 0 5 10 15 20 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "[0,5)" "[5,10)" "[10,15)" "[15,20)" ...</span></span>
<span><span class="co">#&gt;   .. ..$ : chr [1:5] "[0,5)" "[5,10)" "[10,15)" "[15,20)" ...</span></span>
<span><span class="co">#&gt;  - attr(*, "age_breaks")= num [1:6] 0 5 10 15 20 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr [1:2] "conmat_setting_prediction_matrix" "list"</span></span>
<span><span class="va">synthetic_settings_5y_fairfield</span><span class="op">$</span><span class="va">home</span></span>
<span><span class="co">#&gt;                 [0,5)       [5,10)      [10,15)      [15,20)     [20,Inf)</span></span>
<span><span class="co">#&gt; [0,5)    1.160003e-01 9.830709e-02 5.153552e-02 2.958917e-02 1.377237e+33</span></span>
<span><span class="co">#&gt; [5,10)   1.039533e-01 1.570231e-01 1.137220e-01 4.114760e-02 4.499173e+26</span></span>
<span><span class="co">#&gt; [10,15)  5.737655e-02 1.197343e-01 1.888259e-01 9.939819e-02 4.376313e+21</span></span>
<span><span class="co">#&gt; [15,20)  3.515043e-02 4.622629e-02 1.060593e-01 1.663848e-01 9.740524e+16</span></span>
<span><span class="co">#&gt; [20,Inf) 1.770787e+34 5.470627e+27 5.054038e+22 1.054247e+18 1.929846e+13</span></span>
<span><span class="va">synthetic_settings_5y_fairfield</span><span class="op">$</span><span class="va">all</span></span>
<span><span class="co">#&gt;               [0,5)    [5,10)    [10,15)    [15,20) [20,Inf)</span></span>
<span><span class="co">#&gt; [0,5)    1.04858409 0.3296462 0.09438879 0.06134469      Inf</span></span>
<span><span class="co">#&gt; [5,10)   0.34752254 4.6872902 0.52828926 0.09026246      Inf</span></span>
<span><span class="co">#&gt; [10,15)  0.10508680 0.5540780 6.73445049 0.57429654      Inf</span></span>
<span><span class="co">#&gt; [15,20)  0.07287437 0.1014032 0.60944139 4.93719307      Inf</span></span>
<span><span class="co">#&gt; [20,Inf)        Inf       Inf        Inf        Inf      Inf</span></span></code></pre></div>
<p>We can use <code>autoplot</code> to plot all at once</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this code is erroring for the moment - something to do with rendering a large plot I think.</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span></span>
<span>  <span class="va">synthetic_settings_5y_fairfield</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Setting-specific synthetic contact matrices (fairfield 2020 projected)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/fairfield-synth-5-plot-1.png" width="700"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nicholas Tierney, <a href="https://www.telethonkids.org.au/contact-us/our-people/g/nick-golding/" class="external-link">Nick Golding</a>, <a href="https://aarathybabu.netlify.app/" class="external-link">Aarathy Babu</a>, Michael Lydeamore.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
